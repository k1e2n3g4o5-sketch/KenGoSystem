<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ç²‹é¢¨éŒ² IKI CARDï½œKenGoå¼ï¼ˆç”Ÿå¹´æœˆæ—¥ã ã‘ã§OKï¼‰</title>
<meta name="theme-color" content="#e9f6ff">
<style>
:root{
  --sky:#e9f6ff; --paper:#ffffff; --soft:#223048; --mut:#6f8296;
  --line:#dfe9f2; --blue:#2b86ff; --gold:#caa236; --bar:#f2f8ff; --badge:#f7fbff;
}
*{box-sizing:border-box} html,body{height:100%;margin:0;background:var(--sky);color:var(--soft);
  font-family:"Hiragino Sans","Noto Sans JP",system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
.wrap{max-width:980px;margin:0 auto;padding:18px 14px}
.header{display:flex;justify-content:space-between;align-items:end;margin-bottom:10px}
.brand{display:flex;align-items:end;gap:10px}
.logo{font-weight:900;font-size:22px;color:#0f2f5a}
.sub{font-size:12px;color:var(--mut)}
.kintsugi{height:28px;width:2px;background:linear-gradient(180deg,transparent,var(--gold) 20%,transparent 80%);border-radius:2px}
.card{background:var(--paper);border:1px solid var(--line);border-radius:16px;padding:14px;box-shadow:0 6px 20px #0000000b}
.grid{display:grid;gap:12px} @media(min-width:880px){.form{grid-template-columns:1fr 1fr}}
.title{font-size:13px;color:var(--mut);margin:0 0 6px 4px}
label{display:block;font-weight:700;margin:6px 4px 4px;font-size:14px}
.input,select{width:100%;font-size:18px;padding:12px 14px;border-radius:12px;border:1.5px solid var(--line);background:#fff}
.input::placeholder{color:#9eb0be}
.btn{width:100%;border:1.5px solid var(--blue);color:#0c2d66;background:#fff;font-weight:900;padding:12px 14px;border-radius:12px;cursor:pointer}
.btn:active{transform:translateY(1px)}
.small{font-size:12px;color:#8a99a8}
.modes{display:flex;gap:8px}.mode{flex:1 1 80px;padding:8px 10px;text-align:center;border:1px solid var(--line);background:#fff;border-radius:12px;cursor:pointer;font-weight:800}
.mode.on{border-color:var(--blue);background:#f5fbff}
.stat{display:grid;grid-template-columns:110px 1fr 52px;gap:8px;align-items:center;margin:7px 0}
.bar{height:14px;background:var(--bar);border:1px solid var(--line);border-radius:9px;overflow:hidden}
.fill{height:100%;width:0;transition:width .45s ease;background:linear-gradient(90deg,#9ed1ff,#2b86ff)}
.pct{text-align:right;font-variant-numeric:tabular-nums}
.tabs{display:flex;gap:8px;margin-top:4px;flex-wrap:wrap}
.tab{flex:1 1 120px;text-align:center;padding:10px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer;font-weight:800}
.tab.on{border-color:var(--blue);background:#f5fbff}
.panel{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff;margin-top:8px}
.rank{margin-top:8px}
.badges{display:flex;gap:6px;flex-wrap:wrap}
.badge{background:var(--badge);border:1px solid var(--line);border-radius:999px;padding:4px 10px;font-size:12px}
.ring{display:grid;place-items:center} svg#ring{filter:drop-shadow(0 3px 6px #0000000a)}
.toast{position:fixed;left:50%;top:10px;transform:translateX(-50%) translateY(-14px);background:#fff;border:1px solid var(--line);border-radius:12px;padding:8px 12px;opacity:0;transition:.35s;font-weight:800;z-index:5}
.toast.in{opacity:1;transform:translateX(-50%) translateY(0)}
/* èƒŒæ™¯ï¼šä¸–ç•Œåœ°å›³ï¼‹ä¸–ç•Œæ¨¹ */
.bg{position:fixed;inset:0;z-index:-1;pointer-events:none}
.bg .map{position:absolute;inset:0;background:
  radial-gradient(1200px 800px at 50% 55%,#9fd3ff33,transparent 60%),
  repeating-linear-gradient(to right,#2b86ff10 0 1px,transparent 1px 58px),
  repeating-linear-gradient(to bottom,#2b86ff10 0 1px,transparent 1px 58px);
  mask-image:radial-gradient(1100px 760px at 50% 55%,#000 30%,transparent 90%)}
.bg svg{position:absolute;left:50%;top:42%;transform:translate(-50%,-50%);opacity:.18}
#ygg .trunk{fill:#2b86ff} #ygg .leaf{fill:#8ec5ff}
.rItem{display:grid;grid-template-columns:40px 1fr 64px;align-items:center;gap:10px;padding:10px;border:1px dashed #ffefc7;border-radius:12px;margin:10px 0;background:#fffdf6}
.rItem:nth-child(n+2){border-style:solid;border-color:#eaf2fb;background:#ffffff}
.rNo{font-weight:900;color:#0f2f5a;text-align:center}.rName{font-size:17px;font-weight:800}
.rCat{font-size:12px;color:#7a8a98}.rPct{font-weight:900;text-align:right}
</style>
</head>
<body>
<div class="bg" aria-hidden="true">
  <div class="map"></div>
  <svg id="ygg" width="760" height="540" viewBox="0 0 760 540">
    <g class="trunk" opacity="0.7">
      <path d="M375 500c-8-62 10-114-12-156-14-26-47-44-70-50 33-3 62 3 83 22-12-42-42-72-86-89 53 6 93 28 116 64 8-34 1-71-20-112 33 37 51 78 54 122 20-28 47-47 80-58-32 25-53 54-62 86 24-18 51-24 83-20-27 7-61 27-74 54-19 42-3 89-13 130z"/>
    </g>
    <g class="leaf" opacity="0.7">
      <circle cx="280" cy="118" r="26"/><circle cx="330" cy="84" r="22"/>
      <circle cx="396" cy="96" r="24"/><circle cx="450" cy="142" r="28"/>
      <circle cx="238" cy="182" r="24"/><circle cx="500" cy="190" r="26"/>
      <circle cx="312" cy="212" r="20"/><circle cx="436" cy="222" r="22"/>
    </g>
  </svg>
</div>

<div id="toast" class="toast" aria-live="polite">ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚</div>

<div class="wrap">
  <div class="header">
    <div class="brand">
      <div class="logo">ç²‹é¢¨éŒ² <span class="sub">â€” IKI CARD</span></div>
      <div class="kintsugi" aria-hidden="true"></div>
    </div>
    <div class="modes" role="group" aria-label="tone">
      <button class="mode on" data-t="morning">æœ</button>
      <button class="mode" data-t="noon">æ˜¼</button>
      <button class="mode" data-t="night">å¤œ</button>
    </div>
  </div>

  <!-- å…¥åŠ› -->
  <div class="card grid form">
    <div>
      <p class="title">â–¶ ã‚ãªãŸï¼ˆç”Ÿå¹´æœˆæ—¥ã ã‘ã§OKï¼‰</p>
      <label>ç”Ÿå¹´æœˆæ—¥ï¼ˆå¿…é ˆï¼‰</label>
      <input id="dob" class="input" inputmode="numeric" placeholder="19900504 / 1990-05-04 / 1990/05/04">
      <label>å‘¼ã³åï¼ˆä»»æ„ï¼‰</label>
      <input id="nick" class="input" placeholder="KenGo / æ—…äººï¼ˆä»»æ„ï¼‰">
      <label>ãƒ¦ãƒ‹ãƒãƒ¼ã‚¹é¸æŠï¼ˆä»»æ„ï¼‰</label>
      <select id="univ">
        <option value="auto">ãŠã¾ã‹ã›</option>
        <option value="op">ONE PIECE</option>
        <option value="hxh">HUNTERÃ—HUNTER</option>
        <option value="dq">ãƒ‰ãƒ©ã‚´ãƒ³ã‚¯ã‚¨ã‚¹ãƒˆ</option>
        <option value="db">ãƒ‰ãƒ©ã‚´ãƒ³ãƒœãƒ¼ãƒ«</option>
        <option value="nrt">NARUTO</option>
        <option value="dis">Disney</option>
      </select>
      <button id="go" class="btn" style="margin-top:10px">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
      <div id="err" class="small" style="display:none;color:#b03f53">æ—¥ä»˜ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚</div>
    </div>

    <div>
      <p class="title">â–¶ å††ã®æ˜Ÿ</p>
      <div class="ring">
        <svg id="ring" width="240" height="240" viewBox="0 0 240 240">
          <circle cx="120" cy="120" r="90" fill="none" stroke="#e9f2ff" stroke-width="10"/>
          <path id="arc" d="" stroke="url(#g)" stroke-width="10" fill="none" stroke-linecap="round"/>
          <defs><linearGradient id="g" x1="0" x2="1"><stop offset="0%" stop-color="#2b86ff"/><stop offset="100%" stop-color="#caa236"/></linearGradient></defs>
          <text id="score" x="120" y="129" text-anchor="middle" font-size="26" font-family="Inter,system-ui" fill="#0e1a2b" font-weight="800">--%</text>
        </svg>
      </div>
      <div class="badges" id="tags"></div>
    </div>
  </div>

  <!-- å‡ºåŠ› -->
  <div id="out" class="card" style="margin-top:12px;display:none">
    <p class="title">â–¶ åŸºæœ¬</p>
    <div class="stat"><div>å®‰å®šï¼ˆHPï¼‰</div><div class="bar"><div id="hp" class="fill"></div></div><div id="hpv" class="pct">â€”%</div></div>
    <div class="stat"><div>è¦–ç‚¹ï¼ˆMPï¼‰</div><div class="bar"><div id="mp" class="fill"></div></div><div id="mpv" class="pct">â€”%</div></div>
    <div class="stat"><div>æ©Ÿå‹•ï¼ˆSPï¼‰</div><div class="bar"><div id="sp" class="fill" style="background:linear-gradient(90deg,#7ee3c1,#2fa37a)"></div></div><div id="spv" class="pct">â€”%</div></div>

    <div class="tabs">
      <div id="t1" class="tab on">ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div>
      <div id="t2" class="tab">ï¼–å¼ï¼ˆï¼…ï¼‰</div>
      <div id="t3" class="tab">ç¿’å¾—ãƒ†ãƒ¼ãƒ–ãƒ«</div>
    </div>

    <div id="p1" class="panel">
      <div class="small">ä¼¼ã¦ã‚‹OSãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆå›ºæœ‰åè©ï¼‰</div>
      <div id="rank" class="rank"></div>
    </div>

    <div id="p2" class="panel" style="display:none">
      <div id="six" class="six"></div>
    </div>

    <div id="p3" class="panel" style="display:none">
      <div id="learn" class="rank"></div>
      <div id="rel" class="small" style="margin-top:6px"></div>
    </div>
  </div>

  <div class="small" style="text-align:center;margin:14px 0">Â© KenGo System â€” é¢¨ã¯å¤–ã«ã€å††ã¯å†…ã«ã€‚</div>
</div>

<script>
/* ãƒˆãƒ¼ãƒ³åˆ‡æ›¿ */
document.querySelectorAll(".mode").forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll(".mode").forEach(x=>x.classList.remove("on"));
    b.classList.add("on");
    const t=b.dataset.t;
    if(t==="morning") document.documentElement.style.setProperty('--sky','#e9f6ff');
    if(t==="noon")    document.documentElement.style.setProperty('--sky','#f8fcff');
    if(t==="night")   document.documentElement.style.setProperty('--sky','#0f1b2c');
  };
});
const $=id=>document.getElementById(id);

/* å…¥åŠ›ï¼†ä¹±æ•° */
function parseDate(v){
  if(!v) return null; v=v.trim();
  if(/^\d{8}$/.test(v)){const y=+v.slice(0,4),m=+v.slice(4,6)-1,d=+v.slice(6,8);
    const dt=new Date(Date.UTC(y,m,d)); if(dt&&dt.getUTCFullYear()===y&&dt.getUTCMonth()===m&&dt.getUTCDate()===d)return dt;}
  const vv=v.replace(/\//g,"-"); if(/^\d{4}-\d{2}-\d{2}$/.test(vv)){
    const [y,m,d]=vv.split("-").map(Number); const dt=new Date(Date.UTC(y,m-1,d));
    if(dt&&dt.getUTCFullYear()===y&&dt.getUTCMonth()===m-1&&dt.getUTCDate()===d)return dt;}
  return null;
}
function rngFromDate(dt){ let s = dt.getUTCFullYear()*10000+(dt.getUTCMonth()+1)*100+dt.getUTCDate();
  s = (s ^ 0x9e3779b9)>>>0; return ()=> (s = Math.imul(1664525,s)+1013904223>>>0) / 2**32; }

/* å…­å¼ãƒ»åŸºæœ¬ */
const KEYS = ["å††","é¢¨","æ ¸","é–“","å’Œ","è¿”"];
function six(dt){
  const R=rngFromDate(dt), w=dt.getUTCDay(), m=dt.getUTCMonth()+1;
  return Array.from({length:6},(_,i)=>{
    const base=0.52+R()*0.30;
    const twist=((w+i)%3===0?0.04:0)+((m%6===i?0.03:0))+(R()-0.5)*0.06;
    return Math.max(0,Math.min(1,base+twist))*100|0;
  });
}
function base(s){ return {
  hp:Math.round(s[0]*0.5+s[2]*0.3+s[5]*0.2),
  mp:Math.round(s[3]*0.5+s[4]*0.3+s[2]*0.2),
  sp:Math.round(s[1]*0.6+s[3]*0.25+s[4]*0.15)
};}
function drawArc(pct){
  const C=120,R=90,a=Math.PI*2*pct,x=C+R*Math.sin(a),y=C-R*Math.cos(a),large=pct>0.5?1:0;
  $("arc").setAttribute("d",`M ${C} ${C-R} A ${R} ${R} 0 ${large} 1 ${x} ${y}`);
  $("score").textContent=Math.round(pct*100)+"%";
}

/* å›ºæœ‰åè©ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆçŸ­ç¸®ï¼‰ */
const POOL=[
 ["ONE PIECE","ãƒ¢ãƒ³ã‚­ãƒ¼ãƒ»Dãƒ»ãƒ«ãƒ•ã‚£","ãƒ­ãƒ­ãƒã‚¢ãƒ»ã‚¾ãƒ­","ãƒŠãƒŸ","ã‚µãƒ³ã‚¸","ãƒ‹ã‚³ãƒ»ãƒ­ãƒ“ãƒ³","ã‚¦ã‚½ãƒƒãƒ—"],
 ["Ghibli","ãƒŠã‚¦ã‚·ã‚«","ã‚·ãƒ¼ã‚¿","ã‚­ã‚­","ã‚¢ã‚·ã‚¿ã‚«","ã‚µãƒ³","ãƒã‚¯"],
 ["Disney","ãƒ¢ã‚¢ãƒŠ","ã‚¨ãƒ«ã‚µ","ãƒ©ãƒ—ãƒ³ãƒ„ã‚§ãƒ«","ã‚¢ãƒªã‚¨ãƒ«"],
 ["HxH","ã‚´ãƒ³","ã‚­ãƒ«ã‚¢","ã‚¯ãƒ©ãƒ”ã‚«","ãƒ¬ã‚ªãƒªã‚ª","ãƒ’ã‚½ã‚«"],
 ["Marvel","ã‚¢ã‚¤ã‚¢ãƒ³ãƒãƒ³","ã‚­ãƒ£ãƒ—ãƒ†ãƒ³ãƒ»ã‚¢ãƒ¡ãƒªã‚«","ã‚½ãƒ¼","ã‚¹ãƒ‘ã‚¤ãƒ€ãƒ¼ãƒãƒ³"],
 ["FF","ã‚¯ãƒ©ã‚¦ãƒ‰","ãƒ†ã‚£ãƒŠ","ãƒ¦ã‚¦ãƒŠ","ç™½é­”é“å£«","ç«œé¨å£«"],
 ["DQ","å‹‡è€…","è³¢è€…","æ­¦é—˜å®¶","ç›—è³Š","éŠã³äºº"],
 ["NARUTO","ã†ãšã¾ããƒŠãƒ«ãƒˆ","ã¯ãŸã‘ã‚«ã‚«ã‚·","æ˜¥é‡ã‚µã‚¯ãƒ©","ã†ã¡ã¯ã‚µã‚¹ã‚±","æ—¥å‘ãƒ’ãƒŠã‚¿"],
 ["Nature","é·¹","ã‚¤ãƒ«ã‚«","ç‹","èœ‚","ç‹¼","æ¢Ÿ"]
];
function rankList(dt,s){
  const R=rngFromDate(dt), peak=Math.max(...s);
  const list=[];
  for(const g of POOL){ const cat=g[0];
    for(let i=1;i<g.length;i++){
      let p=70+(R()*20-10)+(peak-70)*0.15;
      if(cat==="ONE PIECE"&&s[1]>s[2]) p+=6;
      if(cat==="HxH"&&s[3]>s[1]) p+=6;
      if(cat==="DQ"&&s[0]>s[5]) p+=4;
      if(cat==="NARUTO"&&s[3]>70) p+=5;
      if(cat==="Disney"&&s[4]>75) p+=6;
      p=Math.max(50,Math.min(99,Math.round(p)));
      list.push({cat,name:g[i],pct:p});
    }
  }
  list.sort((a,b)=>b.pct-a.pct||a.name.localeCompare(b.name));
  return list.slice(0,10);
}

/* ãƒ¦ãƒ‹ãƒãƒ¼ã‚¹ææ¡ˆãƒ†ãƒ¼ãƒ–ãƒ« */
const SUGGEST={
  op:{ // æ‚ªé­”ã®å®Ÿï¼šç›¸æ€§MAX / ã™ãè¦šãˆ
    max:[["é¢¨","ã‚´ãƒ­ã‚´ãƒ­ã®å®Ÿ"],["æ ¸","ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã®å®Ÿ"],["å††","ãƒ›ãƒ“ãƒ›ãƒ“ã®å®Ÿ"],["é–“","ãƒ‰ã‚¢ãƒ‰ã‚¢ã®å®Ÿ"],["å’Œ","ã‚ªãƒšã‚ªãƒšã®å®Ÿ"],["è¿”","ãƒ¢ãƒãƒ¢ãƒã®å®Ÿ"]],
    now:[["é¢¨","ã‚¹ãƒ™ã‚¹ãƒ™ã®å®Ÿ"],["æ ¸","ãƒãƒªãƒãƒªã®å®Ÿ"],["å††","ã‚½ãƒ«ã‚½ãƒ«ã®å®Ÿ"],["é–“","ã‚«ã‚²ã‚«ã‚²ã®å®Ÿ"],["å’Œ","ãƒ›ãƒ­ãƒ›ãƒ­ã®å®Ÿ"],["è¿”","ãƒãƒ„ãƒãƒ„ã®å®Ÿ"]]
  },
  hxh:{ // å¿µç³»çµ±ï¼†æŠ€
    max:[["é¢¨","æ”¾å‡ºç³»ï¼šç¥é€Ÿ"],["æ ¸","å¼·åŒ–ç³»ï¼šç¡¬ï¼‹å‰›"],["å††","ç‰¹è³ªç³»ï¼šå††ç†Ÿ"],["é–“","æ“ä½œç³»ï¼šãƒªã‚ºãƒ åˆ»ã¿"],["å’Œ","å…·ç¾åŒ–ç³»ï¼šçµç•Œå…·ç¾"],["è¿”","å¤‰åŒ–ç³»ï¼šé›·æŒ"]],
    now:[["é¢¨","æ”¾å‡ºï¼šç–¾é¢¨å¼¾"],["æ ¸","å¼·åŒ–ï¼šé‰„å£"],["å††","ç‰¹è³ªï¼šå…±é³´"],["é–“","æ“ä½œï¼šã‚¹ãƒ†ãƒƒãƒ—åˆ¶å¾¡"],["å’Œ","å…·ç¾ï¼šæ¶ã‘æ©‹"],["è¿”","å¤‰åŒ–ï¼šåè»¢åˆƒ"]]
  },
  dq:{ // å‘ªæ–‡/ç‰¹æŠ€
    max:[["é¢¨","ãƒã‚¤ã‚­ãƒ«ãƒˆ"],["æ ¸","ã‚¹ã‚¯ãƒ«ãƒˆ"],["å††","ãƒªãƒ™ãƒ›ã‚¤ãƒ "],["é–“","ãƒ•ãƒãƒ¼ãƒ"],["å’Œ","ãƒãƒ›ã‚«ãƒ³ã‚¿"],["è¿”","ãƒ¡ã‚¬ãƒ³ãƒ†ï¼ˆåè»¢æ°£ï¼‰"]],
    now:[["é¢¨","ãƒ”ã‚ªãƒªãƒ "],["æ ¸","ã‚¹ã‚«ãƒ©"],["å††","ãƒ™ãƒ›ã‚¤ãƒŸ"],["é–“","ãƒã‚¸ãƒƒã‚¯ãƒãƒªã‚¢"],["å’Œ","ãƒªãƒ›ã‚¤ãƒŸ"],["è¿”","ã‹ãˆã‚“æ–¬ã‚Š"]]
  },
  db:{ // æŠ€
    max:[["é¢¨","ç¬é–“ç§»å‹•"],["æ ¸","å…ƒæ°—ç‰"],["å††","ç•Œç‹æ‹³ï¼ˆæŒç¶šå‹ï¼‰"],["é–“","æ™‚é–“å·®æ®‹åƒæ‹³"],["å’Œ","æ°—å††æ–¬ï¼ˆèª¿åœåˆƒï¼‰"],["è¿”","ã‹ã‚ã¯ã‚æ³¢ãƒ»é€†æµ"]],
    now:[["é¢¨","èˆç©ºè¡“"],["æ ¸","å²©çŸ³å‰²"],["å††","æ°—ã®ç›¾"],["é–“","æ®‹åƒæ‹³"],["å’Œ","æ°—ã®æµã—"],["è¿”","æ°—åˆå¼¾"]]
  },
  nrt:{ // å¿è¡“
    max:[["é¢¨","é¢¨éãƒ»èºæ—‹æ‰‹è£å‰£"],["æ ¸","åœŸéãƒ»å²©ç‰¢"],["å††","å½±åˆ†èº«ãƒ»å®Œå…¨åˆ¶å¾¡"],["é–“","æ™‚ç©ºé–“ãƒãƒ¼ã‚­ãƒ³ã‚°"],["å’Œ","å°å°è¡“ãƒ»å’Œç´‹"],["è¿”","é›·éãƒ»åƒé³¥è¿”ã—"]],
    now:[["é¢¨","é¢¨éãƒ»çœŸç©ºç‰"],["æ ¸","åœŸéãƒ»åœŸæµå£"],["å††","å½±åˆ†èº«"],["é–“","ç¬èº«ã®è¡“"],["å’Œ","åŒ»ç™‚å¿è¡“ï¼ˆå®‰å®šï¼‰"],["è¿”","é›·éãƒ»é›·å…‰æŒ"]]
  },
  dis:{ // ãƒ­ãƒ¼ãƒ«
    max:[["é¢¨","Wayfinderï¼ˆé¢¨ã®èˆªè·¯é–‹æ‹“è€…ï¼‰"],["æ ¸","Guardianï¼ˆå®ˆè­·è€…ï¼‰"],["å††","Circle Makerï¼ˆè¼ªã‚’ç”Ÿã‚€äººï¼‰"],["é–“","Time Dancerï¼ˆé–“ã®è¸Šã‚Šæ‰‹ï¼‰"],["å’Œ","Harmony Weaverï¼ˆèª¿å’Œã®ç¹”ã‚Šæ‰‹ï¼‰"],["è¿”","Light Reverserï¼ˆåè»¢ã™ã‚‹å…‰ï¼‰"]],
    now:[["é¢¨","Messenger"],["æ ¸","Keeper"],["å††","Friend Maker"],["é–“","Guide"],["å’Œ","Mediator"],["è¿”","Spark"]]
  }
};
/* å…­å¼â†’ä¸»å±æ€§ã‚­ãƒ¼ */
function mainKey(s){ const i=s.indexOf(Math.max(...s)); return ["å††","é¢¨","æ ¸","é–“","å’Œ","è¿”"][i]; }

/* ç¿’å¾—ãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆï¼‹ç›¸å¯¾æ€§ */
function learnBlock(univ,s){
  const mk=mainKey(s);
  const table=SUGGEST[univ];
  const pick=(arr)=> (arr.find(([k])=>k===mk)||arr[0])[1];
  const now=pick(table.now), max=pick(table.max);

  // ç›¸å¯¾æ€§ãƒœãƒ¼ãƒŠã‚¹ï¼šMPã¨é–“ã®åˆæˆ
  const mp=s[3], interval=s[3]; // é–“ï¼index3
  const bonus=Math.round((s[3]+s[1]*0.2)/6); // â€œè¦–ç‚¹â€ã¨â€œé¢¨â€ã§æ™‚é–“ã®ä¼¸ç¸®ã‚’æ„Ÿã˜ã‚‹
  let rel="";
  if(s[3]>=78 || s[3]>=72 && s[1]>=72){
    rel=`â± ç›¸å¯¾æ€§ãƒœãƒ¼ãƒŠã‚¹ï¼šæ™‚é–“ã®ä¼¸ç¸® +${bonus}%ï¼ˆè¦–ç‚¹Ã—é–“ã®åŒèª¿ï¼‰`;
  }else{
    rel=`â± ç›¸å¯¾æ€§ãƒœãƒ¼ãƒŠã‚¹å€™è£œï¼šè¦–ç‚¹ï¼ˆMPï¼‰ã¨é–“ãŒä¸ŠãŒã‚‹æ—¥ã€æŠ€ã®ç™ºå‹•çŒ¶äºˆãŒä¼¸ã³ã¾ã™ã€‚`;
  }

  const box=$("learn"); box.innerHTML="";
  const mkTag = `<span class="badge">ä¸»å±æ€§ï¼š${mk}</span>`;
  const b1=document.createElement("div"); b1.className="rItem";
  b1.innerHTML=`<div class="rNo">â˜…</div><div><div class="rName">ç›¸æ€§MAX</div><div class="rCat">${mkTag}</div></div><div class="rPct">${max}</div>`;
  const b2=document.createElement("div"); b2.className="rItem";
  b2.innerHTML=`<div class="rNo">â–¶</div><div><div class="rName">ä»Šã™ãè¦šãˆã‚‰ã‚Œãã†</div><div class="rCat">${mkTag}</div></div><div class="rPct">${now}</div>`;
  box.appendChild(b1); box.appendChild(b2);
  $("rel").textContent=rel;
}

/* UIæç”» */
function fillBars(s){
  const b=base(s);
  $("hp").style.width=b.hp+"%"; $("hpv").textContent=b.hp+"%";
  $("mp").style.width=b.mp+"%"; $("mpv").textContent=b.mp+"%";
  $("sp").style.width=b.sp+"%"; $("spv").textContent=b.sp+"%";
  const box=$("six"); box.innerHTML="";
  s.forEach((v,i)=>{
    const row=document.createElement("div"); row.className="stat";
    row.innerHTML=`<div>${KEYS[i]}</div><div class="bar"><div class="fill" style="width:${v}%"></div></div><div class="pct">${v}%</div>`;
    box.appendChild(row);
  });
  // ãƒãƒƒã‚¸
  const tags=$("tags"); tags.innerHTML="";
  const highs=KEYS.map((k,i)=>({k,v:s[i]})).filter(x=>x.v>=75).map(x=>x.k+"75+");
  (highs.length?highs:["å‡æ•´"]).forEach(t=>{const b=document.createElement("div");b.className="badge";b.textContent=t;tags.appendChild(b);});
}
function showTab(n){[1,2,3].forEach(i=>{$("t"+i).classList.toggle("on",i===n);$("p"+i).style.display=(i===n?"block":"none");});}
$("t1").onclick=()=>showTab(1); $("t2").onclick=()=>showTab(2); $("t3").onclick=()=>showTab(3);
function toast(m){const t=$("toast");t.textContent=m;t.classList.add("in");setTimeout(()=>t.classList.remove("in"),1300);}

/* ã‚¹ã‚¿ãƒ¼ãƒˆ */
function start(){
  const dt=parseDate($("dob").value);
  if(!dt){$("err").style.display="block";return;} $("err").style.display="none";
  const s=six(dt); fillBars(s);
  const avg=s.reduce((a,b)=>a+b,0)/600; drawArc(avg);
  // ãƒ©ãƒ³ã‚­ãƒ³ã‚°
  const list=rankList(dt,s), box=$("rank"); box.innerHTML="";
  list.forEach((r,i)=>{const item=document.createElement("div");item.className="rItem";
    item.innerHTML=`<div class="rNo">${i+1}</div>
      <div><div class="rName">${i===0?"ğŸ‘‘ ":""}${r.name}</div><div class="rCat">${r.cat}</div></div>
      <div class="rPct">${r.pct}%</div>`; box.appendChild(item);});
  // ç¿’å¾—ï¼ˆãƒ¦ãƒ‹ãƒãƒ¼ã‚¹ï¼‰
  const u=$("univ").value==="auto" ? (list[0].cat==="ONE PIECE"?"op":
    list[0].cat==="HxH"?"hxh": list[0].cat==="NARUTO"?"nrt":
    list[0].cat==="DQ"?"dq": list[0].cat==="FF"||list[0].cat==="DB"?"db":
    list[0].cat==="Disney"?"dis":"op")
    : $("univ").value;
  learnBlock(u,s);
  $("out").style.display="block"; showTab(1); toast("ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚");
}
$("go").onclick=start;

/* å††ã®æ˜Ÿ åˆæœŸåŒ–ï¼ˆURLå¾©å…ƒãªã—ã®è»½é‡ç‰ˆï¼‰ */
</script>
</body>
</html>