<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>KenGoå¼ï¼šé¢¨Ã—å††Ã—ã‚´ãƒ  è¨ºæ–­ï¼ˆç›¸æ€§ã¤ããƒ»è‡ªç”±å…¥åŠ›æ—¥ä»˜ï¼‰</title>
<meta name="description" content="KenGoå¼ Elastic Human OSï¼ˆé¢¨Ã—å††Ã—ã‚´ãƒ ï¼‰ã®ç°¡æ˜“è¨ºæ–­ï¼†ç›¸æ€§ãƒã‚§ãƒƒã‚«ãƒ¼ã€‚ç”Ÿå¹´æœˆæ—¥ã¯19900504 / 1990-05-04 / 1990/05/04ãªã©è‡ªç”±å…¥åŠ›ã€‚">
<style>
:root{
  --bg:#0d1017; --card:#151b2e; --ink:#eef6ff; --sub:#a9c3e6;
  --acc:#8be9fd; --ok:#a6ffcb; --rose:#ffb3c7; --vio:#cbb6ff; --sun:#ffe08a;
  --line: rgba(255,255,255,.10);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background: radial-gradient(1200px 800px at 70% -10%, #1a2144 0%, var(--bg) 60%);
  color: var(--ink);
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
  font-size: 20px;
  line-height: 1.7;
}
.wrap{padding: 22px}
.card{
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
  border: 1px solid var(--line);
  border-radius: 22px;
  padding: 26px;
  max-width: 860px;
  margin: 26px auto;
  box-shadow: 0 20px 50px rgba(0,0,0,.45);
  backdrop-filter: blur(6px);
}
h1{font-size: 28px; margin: 6px 0 16px}
.lead{color:var(--sub); margin: 6px 2px 16px}
.kv{display:flex; gap:14px; align-items:center; flex-wrap:wrap}
.kv .big{font-size: 36px}
.grid{display:grid; grid-template-columns:1fr; gap:16px; margin: 16px 0}
@media (min-width:680px){ .grid{grid-template-columns:1fr 1fr} }
label{display:block; margin: 6px 8px; font-size: 20px}
.input{
  width:100%; padding:14px 16px; border-radius:16px;
  border:1px solid #23304d; background:#0c1224; color:#fff; font-size:20px;
}
.input::placeholder{color:#6f87a8}
.hint{font-size:14px; color:var(--sub); margin:6px 8px 0}
.err{font-size:14px; color:#ff9aa5; margin:6px 8px 0; display:none}
button{
  width:100%; padding:16px 18px; border:0; border-radius:16px;
  background: linear-gradient(90deg, var(--acc), var(--vio));
  color:#001018; font-weight:800; font-size:22px; cursor:pointer; margin-top: 10px;
}
.smallbtn{
  width:auto; padding:10px 14px; font-size:18px; border-radius:12px; margin-left:8px
}
.sep{height:1px; background:var(--line); margin:18px 0}
.badges{display:flex; flex-wrap:wrap; gap:10px; margin:6px 0}
.badge{
  background:#101834; border:1px solid var(--line);
  padding:8px 12px; border-radius:999px; display:inline-flex; align-items:center; gap:8px; font-size:18px;
}
.emo{font-size:22px}
.result{
  margin-top: 14px;
  padding: 18px; border-radius:18px;
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border: 1px solid var(--line);
}
h2{font-size:24px; margin: 6px 0 10px}
h3{font-size:20px; margin: 12px 0 6px}
.kawaii b{color:var(--ok)}
.tag{
  background:#1a213e; border:1px solid var(--line);
  padding:8px 12px; border-radius:12px; font-size:16px; display:inline-block; margin-right:8px; margin-bottom:6px;
}
.footer{color:var(--sub); font-size:14px; margin-top: 8px}
.langtoggle{color:#cfe7ff; text-decoration:underline; background:none; border:none; cursor:pointer; font-size:18px}
.center{display:flex; justify-content:center; gap:12px; flex-wrap:wrap}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="kv">
        <div class="big">ğŸŒ€</div>
        <div>
          <h1 id="t_title">KenGoå¼ï¼šé¢¨ Ã— å†† Ã— ã‚´ãƒ  è¨ºæ–­</h1>
          <p class="lead" id="t_lead">ç”Ÿå¹´æœˆæ—¥ã¯ã€Œ19900504 / 1990-05-04 / 1990/05/04ã€å½¢å¼ã§OKã€‚ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã¯ä»»æ„ã€‚ç›¸æ€§ã‚‚åŒç”»é¢ã§ã€‚</p>
          <button class="langtoggle" id="langBtn" aria-label="switch language">æ—¥æœ¬èª / English</button>
        </div>
      </div>

      <!-- è‡ªåˆ†ã®å…¥åŠ› -->
      <div class="grid">
        <div class="card" style="margin:0">
          <h3 id="t_you">ã‚ãªãŸ / You</h3>
          <label id="t_nick1">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼ˆä»»æ„ï¼‰</label>
          <input class="input" type="text" id="nickA" placeholder="ä¾‹ï¼šKenGo / Optional" />
          <label id="t_birth1">ç”Ÿå¹´æœˆæ—¥ï¼ˆè‡ªç”±å…¥åŠ›ï¼‰</label>
          <input class="input" id="dateA" inputmode="numeric" autocomplete="bday"
                 placeholder="19900504 / 1990-05-04 / 1990/05/04" />
          <div class="hint" id="t_hintA">8æ¡ã¾ãŸã¯åŒºåˆ‡ã‚Šã¤ãã§ã‚‚OKã€‚è‡ªå‹•ã§èªè­˜ã—ã¾ã™ã€‚</div>
          <div class="err" id="errA">æ—¥ä»˜ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</div>
          <div class="badges">
            <span class="badge"><span class="emo">ğŸ’¨</span><span id="t_hint1">é¢¨Ã—å††Ã—ã‚´ãƒ ã®â€œOSã‚¿ã‚¤ãƒ—â€ã‚’ç®—å‡º</span></span>
          </div>
          <button id="btnSelf">è¨ºæ–­ / Analyze</button>
        </div>

        <!-- ç›¸æ‰‹ã®å…¥åŠ›ï¼ˆä»»æ„ï¼‰ -->
        <div class="card" style="margin:0">
          <h3 id="t_partner">ç›¸æ€§ãƒã‚§ãƒƒã‚¯ï¼ˆä»»æ„ï¼‰ / Compatibility (Optional)</h3>
          <label id="t_nick2">ç›¸æ‰‹ã®ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼ˆä»»æ„ï¼‰</label>
          <input class="input" type="text" id="nickB" placeholder="ä¾‹ï¼šRin / Optional" />
          <label id="t_birth2">ç›¸æ‰‹ã®ç”Ÿå¹´æœˆæ—¥ï¼ˆè‡ªç”±å…¥åŠ›ï¼‰</label>
          <input class="input" id="dateB" inputmode="numeric" autocomplete="bday"
                 placeholder="19940322 / 1994-03-22 / 1994/03/22" />
          <div class="hint" id="t_hintB">ä¸¡æ–¹ã®ç”Ÿå¹´æœˆæ—¥ãŒã‚ã‚Œã°ç›¸æ€§ã‚’è¡¨ç¤ºã€‚</div>
          <div class="err" id="errB">ç›¸æ‰‹ã®æ—¥ä»˜ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</div>
          <button id="btnBoth">ç›¸æ€§ã¾ã§è¨ºæ–­ / Analyze Both</button>
        </div>
      </div>

      <div class="sep"></div>

      <!-- çµæœè¡¨ç¤º -->
      <div class="result" id="selfBox" hidden>
        <h2 id="t_self_title">ã‚ãªãŸã®çµæœ / Your Result</h2>
        <div class="badges" id="selfBadges"></div>
        <p class="kawaii" id="selfText"></p>
      </div>

      <div class="result" id="pairBox" hidden>
        <h2 id="t_pair_title">ç›¸æ€§çµæœ / Compatibility</h2>
        <div class="badges" id="pairBadges"></div>
        <p class="kawaii" id="pairText"></p>
      </div>

      <div class="sep"></div>
      <div class="center">
        <span class="tag">ğŸ§© Elastic Human OS</span>
        <span class="tag">ğŸ’  Core = Rubber / æŠ˜ã‚Œãªã„æ ¸</span>
        <span class="tag">ğŸ’¨ Wind = Flow / é¢¨ã®å¾ªç’°</span>
        <span class="tag">â­• Circle = Return / å††ã«æˆ»ã‚‹</span>
      </div>
      <p class="footer" id="t_footer">
        ã“ã‚Œã¯ã‚¨ãƒ³ã‚¿ãƒ¡è¨ºæ–­ã§ã™ã€‚ä½“æ„Ÿï¼ˆBâ†’Aï¼‰ã‚’ãŸã®ã—ã‚“ã§ã­ã€‚/ This is for fun & reflection.
      </p>
    </div>
  </div>

<script>
(() => {
  // ====== i18n ======
  const jp = {
    title: "KenGoå¼ï¼šé¢¨ Ã— å†† Ã— ã‚´ãƒ  è¨ºæ–­",
    lead: "ç”Ÿå¹´æœˆæ—¥ã¯ã€Œ19900504 / 1990-05-04 / 1990/05/04ã€å½¢å¼ã§OKã€‚ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã¯ä»»æ„ã€‚ç›¸æ€§ã‚‚åŒç”»é¢ã§ã€‚",
    you: "ã‚ãªãŸ / You",
    nick1: "ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼ˆä»»æ„ï¼‰",
    birth1: "ç”Ÿå¹´æœˆæ—¥ï¼ˆè‡ªç”±å…¥åŠ›ï¼‰",
    hintA: "8æ¡ã¾ãŸã¯åŒºåˆ‡ã‚Šã¤ãã§ã‚‚OKã€‚è‡ªå‹•ã§èªè­˜ã—ã¾ã™ã€‚",
    partner: "ç›¸æ€§ãƒã‚§ãƒƒã‚¯ï¼ˆä»»æ„ï¼‰ / Compatibility (Optional)",
    nick2: "ç›¸æ‰‹ã®ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼ˆä»»æ„ï¼‰",
    birth2: "ç›¸æ‰‹ã®ç”Ÿå¹´æœˆæ—¥ï¼ˆè‡ªç”±å…¥åŠ›ï¼‰",
    hintB: "ä¸¡æ–¹ã®ç”Ÿå¹´æœˆæ—¥ãŒã‚ã‚Œã°ç›¸æ€§ã‚’è¡¨ç¤ºã€‚",
    hint1: "é¢¨Ã—å††Ã—ã‚´ãƒ ã®â€œOSã‚¿ã‚¤ãƒ—â€ã‚’ç®—å‡º",
    btnSelf: "è¨ºæ–­ / Analyze",
    btnBoth: "ç›¸æ€§ã¾ã§è¨ºæ–­ / Analyze Both",
    selfTitle: "ã‚ãªãŸã®çµæœ / Your Result",
    pairTitle: "ç›¸æ€§çµæœ / Compatibility",
    footer: "ã“ã‚Œã¯ã‚¨ãƒ³ã‚¿ãƒ¡è¨ºæ–­ã§ã™ã€‚ä½“æ„Ÿï¼ˆBâ†’Aï¼‰ã‚’ãŸã®ã—ã‚“ã§ã­ã€‚/ This is for fun & reflection.",
    err: "æ—¥ä»˜ã®å½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"
  };
  const en = {
    title: "KenGo Method: Wind Ã— Circle Ã— Rubber â€” Typing",
    lead: "Enter your birthday in formats like 19900504 / 1990-05-04 / 1990/05/04. Nickname optional. Compatibility available.",
    you: "You",
    nick1: "Nickname (optional)",
    birth1: "Date of Birth (free input)",
    hintA: "8 digits or with separators â€” we parse it for you.",
    partner: "Compatibility (Optional)",
    nick2: "Partner Nickname (optional)",
    birth2: "Partner Date of Birth (free input)",
    hintB: "If both birthdays exist, compatibility will show.",
    hint1: "Computes your Wind Ã— Circle Ã— Rubber OS",
    btnSelf: "Analyze",
    btnBoth: "Analyze Both",
    selfTitle: "Your Result",
    pairTitle: "Compatibility",
    footer: "This is for fun & reflection. Enjoy the Bâ†’A flow.",
    err: "Please check the date format."
  };
  let isJP = (navigator.language || navigator.userLanguage || "ja").startsWith("ja");
  const $ = (id) => document.getElementById(id);
  const T = () => (isJP ? jp : en);

  function applyLang(){
    $("t_title").textContent = T().title;
    $("t_lead").textContent = T().lead;
    $("t_you").textContent = T().you;
    $("t_nick1").textContent = T().nick1;
    $("t_birth1").textContent = T().birth1;
    $("t_hintA").textContent = T().hintA;
    $("t_partner").textContent = T().partner;
    $("t_nick2").textContent = T().nick2;
    $("t_birth2").textContent = T().birth2;
    $("t_hintB").textContent = T().hintB;
    $("t_hint1").textContent = T().hint1;
    $("btnSelf").textContent = T().btnSelf;
    $("btnBoth").textContent = T().btnBoth;
    $("t_self_title").textContent = T().selfTitle;
    $("t_pair_title").textContent = T().pairTitle;
    $("t_footer").textContent = T().footer;
    $("errA").textContent = T().err;
    $("errB").textContent = T().err;
  }
  $("langBtn").addEventListener("click", ()=>{ isJP = !isJP; applyLang(); });
  applyLang();

  // ====== Flexible Date Parser ======
  // å—ã‘å…¥ã‚Œï¼šYYYYMMDD / YYYY-MM-DD / YYYY/MM/DD / ç©ºç™½æ··ã˜ã‚Šã‚‚å¯
  function parseFlexibleDate(str){
    if(!str) return null;
    const s = String(str).trim();
    if(!s) return null;
    // å…¨è§’â†’åŠè§’
    const z2h = s.replace(/[ï¼-ï¼™ï¼ï¼ï¼ãƒ¼âˆ’]/g, (ch)=>{
      const map = {"ï¼":"0","ï¼‘":"1","ï¼’":"2","ï¼“":"3","ï¼”":"4","ï¼•":"5","ï¼–":"6","ï¼—":"7","ï¼˜":"8","ï¼™":"9","ï¼":"/","ï¼":"-","ãƒ¼":"-","âˆ’":"-"};
      return map[ch] ?? ch;
    });
    // æ•°å­—ã®ã¿å–ã‚Šå‡ºã—
    const digits = z2h.replace(/[^\d]/g,"");
    if(digits.length !== 8) return null;
    const y = +digits.slice(0,4);
    const m = +digits.slice(4,6);
    const d = +digits.slice(6,8);
    if(m<1||m>12||d<1||d>31) return null;
    // ç°¡æ˜“å¦¥å½“æ€§ï¼ˆ2æœˆãƒ»ã†ã‚‹ã†å¹´ã¯ç°¡ä¾¿ãƒã‚§ãƒƒã‚¯ï¼‰
    const mdays = [31, (y%4===0 && (y%100!==0||y%400===0))?29:28,31,30,31,30,31,31,30,31,30,31];
    if(d > mdays[m-1]) return null;
    return {y,m,d};
  }
  // å…¥åŠ›æ¬„ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºåˆ¶å¾¡
  function setError(id, show){
    const el = $(id);
    el.style.display = show ? "block" : "none";
  }

  // ====== Typing Logic ======
  const ELEMENTS = ["WIND","FIRE","WATER","EARTH"];
  const EMOJI = {WIND:"ğŸ’¨", FIRE:"ğŸ”¥", WATER:"ğŸŒŠ", EARTH:"ğŸª¨"};
  const JP_NAME = {WIND:"é¢¨", FIRE:"ç«", WATER:"æ°´", EARTH:"åœ°"};
  const TAGLINES_JP = {
    WIND: "é¢¨ãŒé€šã‚‹ã¨ä¸–ç•ŒãŒè»½ã„ã€‚åˆå›³ã¯â€œå‘¼å¸ã®æ·±ã•â€ã€‚",
    FIRE: "ç«ã¯æ„å¿—ã€‚ç‚¹ç«ã™ã‚Œã°å‘¨å›²ã‚‚æ˜ã‚‹ãæ¸©ã‹ã„ã€‚",
    WATER: "æ°´ã¯ä½™ç™½ã€‚å—ã‘ã¦æº¶ã‹ã—ã€é™ã‹ã«æº€ãŸã™ã€‚",
    EARTH:"åœ°ã¯å®‰å®šã€‚åœŸå°ãŒæ•´ãˆã°ã™ã¹ã¦ãŒè‚²ã¤ã€‚"
  };
  const TAGLINES_EN = {
    WIND: "When wind flows, the world feels light. Your sign is deeper breathing.",
    FIRE: "Fire is will. Once ignited, others warm and see further.",
    WATER:"Water is space. You dissolve pressure and fill quietly.",
    EARTH:"Earth is stability. With foundation set, everything grows."
  };
  const COMP = {
    WIND:   {WIND:"GOOD", FIRE:"GREAT", WATER:"GOOD", EARTH:"NEUTRAL"},
    FIRE:   {WIND:"GREAT", FIRE:"SPICY", WATER:"GOOD", EARTH:"GOOD"},
    WATER:  {WIND:"GOOD", FIRE:"GOOD", WATER:"GOOD", EARTH:"GREAT"},
    EARTH:  {WIND:"NEUTRAL", FIRE:"GOOD", WATER:"GREAT", EARTH:"GOOD"},
  };
  const COMP_EMO = {GREAT:"ğŸ’", GOOD:"ğŸ’«", NEUTRAL:"ğŸŒ—", SPICY:"ğŸŒ¶ï¸"};
  const COMP_JP = {
    GREAT:"æœ€é«˜ã®è¿½ã„é¢¨ã€‚æ”¾ã£ã¦ãŠã„ã¦ã‚‚å›ã‚‹ç›¸æ€§ã€‚",
    GOOD:"å¿ƒåœ°ã‚ˆãä¼¸ã³ã‚‹é–¢ä¿‚ã€‚å°‘ã—ã®åˆå›³ã§ååˆ†ã€‚",
    NEUTRAL:"å¯ã‚‚ä¸å¯ã‚‚ãªã—ã€‚å„€å¼ï¼ˆåˆå›³ï¼‰ã‚’æ±ºã‚ã‚‹ã¨å®‰å®šã€‚",
    SPICY:"åˆºæ¿€çš„ã€‚ãƒšãƒ¼ã‚¹é…æ…®ã¨â€œåˆå›³ã®ç´„æŸâ€ãŒéµã€‚"
  };
  const COMP_EN = {
    GREAT:"Top-tier tailwind. It turns by itself.",
    GOOD:"Comfortable growth. Small signals are enough.",
    NEUTRAL:"So-so. Set a ritual cue and it stabilizes.",
    SPICY:"Spicy & fun. Pace care + signal pact are keys."
  };

  function elementFromYMD(ymd){
    // å…ƒç´ ã‚¿ã‚¤ãƒ—ï¼š (month + day) % 4 ã§ç°¡æ˜“åˆ†é¡ï¼ˆãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ï¼‰
    const idx = (ymd.m + ymd.d) % 4;
    return ELEMENTS[idx];
  }
  function fancyName(el){
    return isJP ? `${JP_NAME[el]}ï¼ˆ${el}ï¼‰` : el;
  }
  function buildSelfText(name, el){
    const line = isJP ? TAGLINES_JP[el] : TAGLINES_EN[el];
    const who = name ? (isJP ? `${name} ã¯` : `${name} is`) : (isJP ? "ã‚ãªãŸã¯" : "You are");
    const headline = {
      WIND: isJP ? "ã—ãªã‚„ã‹ãªé¢¨ï¼å—ã‘è¿”ã™é”äºº" : "Supple Wind / Master of Return",
      FIRE: isJP ? "ç¯ã™ç«ï¼ç‚¹ç«ã®å°ç·š" : "Kindling Fire / Sparkline",
      WATER:isJP ? "ã‚„ã‚ã‚‰ã‹ãªæ°´ï¼ä½™ç™½ã®é­”æ³•" : "Gentle Water / Space Maker",
      EARTH:isJP ? "ã‚†ã‚‹ããªã„åœ°ï¼åœŸå°ãƒ“ãƒ«ãƒ€ãƒ¼" : "Steady Earth / Ground Builder",
    }[el];
    const tip = isJP
      ? "åˆå›³ï¼šå‘¼å¸ãƒ»å§¿å‹¢ãƒ»ä¸€åº¦ç«‹ã¡æ­¢ã¾ã‚‹ã€‚å¤–åœ§ã¯â€œå¸åâ†’èª¿æ•´â†’è¿”ã™â€ã€‚"
      : "Cue: breath, posture, tiny pause. Handle pressure with â€œabsorb â†’ modulate â†’ reflect.â€";
    return `ğŸª„ <b>${who} ${fancyName(el)}</b>ã€‚<br>${line}<br><br><b>ã€${headline}ã€‘</b><br>${tip}`;
  }
  function buildSelfBadges(el){
    const box = $("selfBadges");
    box.innerHTML = "";
    const mk = (txt)=>{ const s=document.createElement("span"); s.className="badge"; s.innerHTML=txt; return s; };
    box.append(
      mk(`<span class="emo">${EMOJI[el]}</span> <b>${fancyName(el)}</b>`),
      mk(`<span class="emo">ğŸ’ </span> Core=Rubber`),
      mk(`<span class="emo">ğŸ’¨</span> Wind=Flow`),
      mk(`<span class="emo">â­•</span> Circle=Return`)
    );
  }
  function buildPair(elA, elB, nameA, nameB){
    const rank = COMP[elA][elB];
    const emo = COMP_EMO[rank];
    const line = isJP ? COMP_JP[rank] : COMP_EN[rank];
    const whoA = nameA || (isJP ? "ã‚ãªãŸ" : "You");
    const whoB = nameB || (isJP ? "ç›¸æ‰‹" : "Partner");
    const lead = isJP ? "ãµãŸã‚Šã®å…ƒç´ " : "Elements";
    const cue = isJP
      ? "åˆå›³ã¥ãã‚Šï¼šâ‘ åˆå›³ã®ã“ã¨ã° â‘¡ä¸€åº¦æ·±å‘¼å¸ â‘¢â€œæˆ»ã‚‹â€ã®åˆè¨€è‘‰ï¼ˆã‚„ã£ã¨ã ã­ï¼‰"
      : "Ritual cues: (1) signal word, (2) shared deep breath, (3) â€œreturnâ€ password (Finally.)";
    $("pairBadges").innerHTML =
      `<span class="badge"><span class="emo">${EMOJI[elA]}</span>${whoA}: ${fancyName(elA)}</span>
       <span class="badge"><span class="emo">${EMOJI[elB]}</span>${whoB}: ${fancyName(elB)}</span>
       <span class="badge"><span class="emo">${emo}</span>${lead}: ${rank}</span>`;
    $("pairText").innerHTML =
      `${emo} <b>${rank}</b> â€” ${line}<br><br>
       <b>${isJP ? "ä½¿ã„æ–¹" : "How to play"}</b>ï¼š${cue}`;
  }

  // ====== UI validate on blur ======
  function hookValidate(inputId, errId){
    const el = $(inputId);
    el.addEventListener("blur", ()=>{
      const ok = !!parseFlexibleDate(el.value);
      setError(errId, !ok && el.value.trim()!=="");
    });
  }
  hookValidate("dateA","errA");
  hookValidate("dateB","errB");

  // ====== Actions ======
  $("btnSelf").addEventListener("click", ()=>{
    const ymd = parseFlexibleDate($("dateA").value);
    if(!ymd){ setError("errA", true); return; }
    setError("errA", false);
    const el = elementFromYMD(ymd);
    const name = $("nickA").value.trim();
    buildSelfBadges(el);
    $("selfText").innerHTML = buildSelfText(name, el);
    $("selfBox").hidden = false;
    $("pairBox").hidden = true;
  });

  $("btnBoth").addEventListener("click", ()=>{
    const ymdA = parseFlexibleDate($("dateA").value);
    const ymdB = parseFlexibleDate($("dateB").value);
    if(!ymdA){ setError("errA", true); }
    if(!ymdB){ setError("errB", true); }
    if(!ymdA || !ymdB) return;
    setError("errA", false); setError("errB", false);
    const elA = elementFromYMD(ymdA);
    const elB = elementFromYMD(ymdB);
    const nameA = $("nickA").value.trim();
    const nameB = $("nickB").value.trim();
    // self
    buildSelfBadges(elA);
    $("selfText").innerHTML = buildSelfText(nameA, elA);
    $("selfBox").hidden = false;
    // pair
    buildPair(elA, elB, nameA, nameB);
    $("pairBox").hidden = false;
    setTimeout(()=>{ $("pairBox").scrollIntoView({behavior:"smooth", block:"start"}); }, 60);
  });
})();
</script>
</body>
</html>