<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>KenGo OS â€” IKI STATUS</title>
<meta name="theme-color" content="#eaf6ff">
<style>
:root{
  --sky:#eaf6ff; --ink:#0e1a2b; --mut:#5e6a7a; --line:#dfe7ef; --card:#ffffff;
  --accent:#2b86ff; --gold:#cfa84a; --sun:#ffcc33; --night:#0d1b2a; --dawn:#fff7e3;
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;font-family:Inter, system-ui, -apple-system, "Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;color:var(--ink);background:var(--sky);letter-spacing:.2px}
h1,h2,p{margin:0}
.wrap{max-width:980px;margin:0 auto;padding:18px}
.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.brand{font-size:20px;font-weight:900;display:flex;align-items:center;gap:10px}
.badge{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);background:#fff;border-radius:999px;padding:4px 10px;font-weight:800;font-size:12px}
.mode{display:flex;gap:8px;flex-wrap:wrap}
.mode button{border:1.5px solid var(--line);background:#fff;border-radius:999px;padding:8px 12px;font-weight:800;cursor:pointer}
.mode .on{border-color:var(--accent);box-shadow:0 0 0 2px #2b86ff22}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:14px}
.grid{display:grid;gap:14px}
@media(min-width:900px){.grid2{grid-template-columns:360px 1fr}}
label{display:block;margin:6px 4px 6px 2px;font-weight:800;color:var(--mut)}
.input{width:100%;font-size:18px;border:1.5px solid var(--line);border-radius:12px;padding:12px 14px}
.input::placeholder{color:#9aa6b2}
.btn{width:100%;border:0;border-radius:12px;padding:14px 16px;font-size:18px;font-weight:900;background:var(--accent);color:#fff;cursor:pointer}
.btn:active{transform:translateY(1px)}
.help{font-size:12px;color:var(--mut);margin-top:6px}
.err{color:#c62828;font-size:13px;margin-top:6px;display:none}

.title{font-size:14px;color:var(--mut);margin:0 0 8px 2px}
.kv{display:grid;grid-template-columns:106px 1fr;gap:12px;align-items:center}
.emblem{width:106px;height:106px;border-radius:999px;border:2px solid var(--line);display:grid;place-items:center;background:#fff;position:relative}
.crown{position:absolute;top:-18px;left:50%;transform:translateX(-50%) rotate(-8deg);font-size:28px;filter:drop-shadow(0 2px 0 #b48a2a)}
.emblem svg{width:86%;height:86%}
.stats{display:grid;gap:10px}
.row{display:grid;grid-template-columns:130px 1fr 52px;gap:10px;align-items:center}
.bar{height:14px;background:#f3f6fa;border:1px solid var(--line);border-radius:9px;overflow:hidden}
.fill{height:100%;width:0;background:linear-gradient(90deg,#8ec5ff,#2b86ff);transition:width .5s ease}
.pct{text-align:right;font-variant-numeric:tabular-nums}
.tabs{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
.tab{flex:1 1 140px;text-align:center;border:1px solid var(--line);border-radius:12px;padding:10px;background:#fff;font-weight:900;cursor:pointer}
.tab.on{border-color:var(--accent);background:#f3f9ff}
.panel{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff;margin-top:8px}
.list{display:grid;gap:8px}
.rank{display:grid;grid-template-columns:36px 1fr 64px;gap:10px;align-items:center;border:1px dashed var(--line);border-radius:12px;padding:10px}
.tag{font-size:12px;color:var(--mut)}
.top{border-color:#ffd67a;background:linear-gradient(0deg,#fff9e6,#fff)}
.share{display:flex;gap:8px;flex-wrap:wrap}
.share .ghost{background:#fff;color:var(--accent);border:1.5px solid var(--accent)}
.note{font-size:12px;color:var(--mut)}
.toast{position:fixed;left:50%;top:12px;transform:translateX(-50%) translateY(-10px);background:#fff;border:1px solid var(--line);border-radius:12px;padding:8px 12px;opacity:0;transition:.35s;font-weight:900;z-index:5}
.toast.in{opacity:1;transform:translateX(-50%) translateY(0)}
/* èƒŒæ™¯ãƒ¢ãƒ¼ãƒ‰ */
body.morning{background:var(--dawn)}
body.day{background:var(--sky)}
body.night{background:linear-gradient(180deg,#0d1b2a,#14243a);color:#e9f2ff}
body.night .card,body.night .panel{background:#0f2035;color:#e9f2ff;border-color:#254060}
body.night .input{background:#0b1a2a;color:#e9f2ff;border-color:#254060}
body.night .bar{background:#0b1d2f;border-color:#254060}
small{color:var(--mut)}
</style>
</head>
<body class="day">
<div id="toast" class="toast" aria-live="polite">ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚</div>

<div class="wrap">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="header">
    <div class="brand">KenGo OS â€” <span class="badge">IKI STATUS</span></div>
    <div class="mode" role="tablist" aria-label="sky mode">
      <button class="on" data-mode="morning">ğŸŒ… æœ</button>
      <button data-mode="day">â˜€ï¸ æ˜¼</button>
      <button data-mode="night">ğŸŒŒ å¤œ</button>
    </div>
  </div>

  <!-- å…¥åŠ› -->
  <div class="grid grid2 card">
    <div>
      <p class="title">â–¶ ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆç”Ÿå¹´æœˆæ—¥ã ã‘ã§OKï¼‰</p>
      <label>ç”Ÿå¹´æœˆæ—¥ <small>19900504 / 1990-05-04 / 1990/05/04</small></label>
      <input id="dob" class="input" inputmode="numeric" placeholder="ä¾‹ï¼‰19900504">
      <label>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ  <small>ä»»æ„</small></label>
      <input id="nick" class="input" placeholder="ä¾‹ï¼‰KenGo / æ—…äºº">
      <div class="help">ã€Œè¨ºæ–­ã™ã‚‹ã€ã‚’æŠ¼ã™ã¨ â€œå††â€ ãŒå…‰ã§æã‹ã‚Œã¦ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãŒå‡ºã¾ã™ã€‚</div>
      <div id="err" class="err">æ—¥ä»˜ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚</div>
      <button id="run" class="btn" style="margin-top:10px">è¨ºæ–­ã™ã‚‹</button>
    </div>

    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆå††ã®ã‚¢ãƒ‹ãƒ¡ï¼‰ -->
    <div>
      <p class="title">â–¶ å††ï¼ˆå…‰ã®åˆ»å°ï¼‰</p>
      <div class="emblem" id="emblem" aria-label="circle emblem">
        <!-- ç‹å† ã¯é–¾å€¤ã§è¡¨ç¤º -->
        <div id="crown" class="crown" style="display:none">ğŸ‘‘</div>
        <svg viewBox="0 0 120 120" id="halo" aria-hidden="true">
          <defs>
            <radialGradient id="glow" cx="50%" cy="50%">
              <stop offset="0%" stop-color="#fff" stop-opacity="0.95"/>
              <stop offset="60%" stop-color="#fff" stop-opacity="0.25"/>
              <stop offset="100%" stop-color="#fff" stop-opacity="0"/>
            </radialGradient>
            <linearGradient id="beam" x1="0" x2="1">
              <stop offset="0%" stop-color="#8ec5ff"/><stop offset="100%" stop-color="#2b86ff"/>
            </linearGradient>
          </defs>
          <circle cx="60" cy="60" r="47" fill="url(#glow)"/>
          <circle cx="60" cy="60" r="47" fill="none" stroke="#eef5ff" stroke-width="3"/>
          <path id="arc" d="" stroke="url(#beam)" stroke-width="5" fill="none" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="help">å®Œæˆæ™‚ã«ğŸ‘‘ãŒç¾ã‚Œã‚‹æ—¥ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆä»Šæ—¥ã®è¿½ã„é¢¨ãƒœãƒ¼ãƒŠã‚¹ï¼‰</div>
    </div>
  </div>

  <!-- çµæœ -->
  <div id="board" class="grid grid2" style="margin-top:14px" hidden>
    <div class="card">
      <p class="title">â–¶ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</p>
      <div class="kv" style="margin-bottom:6px">
        <div></div>
        <div>
          <div id="who" style="font-weight:900;font-size:20px">â€”</div>
          <div class="tag" id="element">â€”</div>
        </div>
      </div>
      <div class="stats">
        <div class="row"><div>å®‰å®šï¼ˆHPï¼‰</div><div class="bar"><div id="hp" class="fill"></div></div><div id="hpv" class="pct">â€”%</div></div>
        <div class="row"><div>è¦–ç‚¹ï¼ˆMPï¼‰</div><div class="bar"><div id="mp" class="fill"></div></div><div id="mpv" class="pct">â€”%</div></div>
        <div class="row"><div>æ©Ÿå‹•ï¼ˆSPï¼‰</div><div class="bar"><div id="sp" class="fill"></div></div><div id="spv" class="pct">â€”%</div></div>
      </div>
    </div>

    <div>
      <div class="tabs">
        <div class="tab on" data-tab="r">ãƒ©ãƒ³ã‚­ãƒ³ã‚°</div>
        <div class="tab" data-tab="s">6å¼ï¼ˆï¼…ï¼‰</div>
        <div class="tab" data-tab="share">ã‚·ã‚§ã‚¢</div>
      </div>

      <div id="pan-r" class="panel">
        <p class="title">â–¶ ä¼¼ã¦ã‚‹OSãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆäººä»¥å¤–ï¼‰</p>
        <div id="list" class="list"></div>
        <div class="note" style="margin-top:8px">â€»AIã®â€œOSã£ã½ã•â€æ¨å®šã€‚ä½œå“ã¯æ•¬æ„ã‚’è¾¼ã‚ãŸã‚ªãƒãƒ¼ã‚¸ãƒ¥ã€‚</div>
      </div>

      <div id="pan-s" class="panel" style="display:none">
        <div class="list" id="six"></div>
      </div>

      <div id="pan-share" class="panel" style="display:none">
        <div class="share">
          <button id="save" class="btn">ç”»åƒã‚’ä¿å­˜</button>
          <button id="share" class="btn ghost">ç«¯æœ«ã®å…±æœ‰ã‚’ä½¿ã†</button>
        </div>
        <canvas id="card" width="1200" height="630" style="display:none"></canvas>
        <div class="help">OGç”»åƒã‚µã‚¤ã‚ºã§ç”Ÿæˆã—ã¾ã™ã€‚å††ãƒ»åå‰ãƒ»æœ¬æ—¥ã®è¦ç´ ã‚’æãè¾¼ã¿ã€‚</div>
      </div>
    </div>
  </div>
</div>

<script>
/* ========= ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ========= */
const $=id=>document.getElementById(id);
const toast=(t)=>{const el=$("toast"); el.textContent=t; el.classList.add("in"); setTimeout(()=>el.classList.remove("in"),1200);};
const modes = document.querySelectorAll('[data-mode]');
modes.forEach(b=>b.onclick=()=>{modes.forEach(x=>x.classList.remove('on')); b.classList.add('on'); document.body.className=b.dataset.mode;});

/* ========= å…¥åŠ›å‡¦ç† ========= */
function parseDate(v){
  if(!v) return null; v=v.trim();
  if(/^\d{8}$/.test(v)){ const y=+v.slice(0,4), m=+v.slice(4,6)-1, d=+v.slice(6,8);
    const dt=new Date(Date.UTC(y,m,d)); if(dt&&dt.getUTCFullYear()===y&&dt.getUTCMonth()===m&&dt.getUTCDate()===d) return dt;}
  const vv=v.replace(/\//g,"-"); if(/^\d{4}-\d{2}-\d{2}$/.test(vv)){
    const [y,m,d]=vv.split("-").map(Number); const dt=new Date(Date.UTC(y,m-1,d));
    if(dt&&dt.getUTCFullYear()===y&&dt.getUTCMonth()===m-1&&dt.getUTCDate()===d) return dt;}
  return null;
}
function rngFromDate(dt){
  let s = dt.getUTCFullYear()*10000 + (dt.getUTCMonth()+1)*100 + dt.getUTCDate();
  s = (s ^ 0x9e3779b9)>>>0; // mix
  return ()=> (s = Math.imul(1664525, s) + 1013904223 >>> 0) / 2**32;
}

/* ========= 6å¼ã¨åŸºæœ¬å€¤ ========= */
const SIX_JA = ["å††","é¢¨","æ ¸","é–“","å’Œ","è¿”"];
function six(dt){
  const R=rngFromDate(dt), w=dt.getUTCDay(), m=dt.getUTCMonth()+1;
  return Array.from({length:6},(_,i)=>{
    const base=0.55+R()*0.28;
    const twist=((w+i)%3===0?0.04:0)+((m%6===i?0.03:0))+(R()-0.5)*0.06;
    return Math.max(0,Math.min(1,base+twist))*100|0;
  });
}
function base(s){ return {
  hp:Math.round(s[0]*0.5+s[2]*0.3+s[5]*0.2),
  mp:Math.round(s[3]*0.5+s[4]*0.3+s[2]*0.2),
  sp:Math.round(s[1]*0.6+s[3]*0.25+s[4]*0.15)
};}
function elementFromSix(s){
  const score = {
    wind: s[1]*0.6 + s[3]*0.4,
    fire: s[5]*0.6 + s[1]*0.4,
    earth: s[2]*0.6 + s[0]*0.4,
    water: s[4]*0.7 + s[0]*0.3
  };
  const key = Object.entries(score).sort((a,b)=>b[1]-a[1])[0][0];
  const label = {wind:"WINDï¼ˆé¢¨ï¼‰",fire:"FIREï¼ˆç«ï¼‰",earth:"EARTHï¼ˆåœ°ï¼‰",water:"WATERï¼ˆæ°´ï¼‰"}[key];
  return {key,label};
}

/* ========= OSãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ»å€™è£œãƒ—ãƒ¼ãƒ« ========= */
/* å„ã‚«ãƒ†ã‚´ãƒªã®ä»£è¡¨åï¼ˆOSçš„é›°å›²æ°—ãƒ©ãƒ™ãƒ«ï¼äººåã¯ä¸ä½¿ç”¨ï¼‰ */
const POOL = [
  // ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼
  ["Disney","ç¯å°ã®æ¡ˆå†…äºº","è‡ªç”±ã‚’æ­Œã†èˆªæµ·è€…","æ£®ã®å®ˆã‚Šæ‰‹","ç™ºæ˜å¥½ããªå°ã•ãªè‹±é›„"],
  // ãƒ¯ãƒ³ãƒ”ãƒ¼ã‚¹
  ["ONE PIECE","ã‚´ãƒ ã®å†’é™ºè€…","å‰£ã‚’æ¥µã‚ã‚‹ç›¸æ£’","èˆªæµ·ã‚’å°ãå­¦è€…","æ–™ç†ã§å ´ã‚’ä¸Šã’ã‚‹äºº"],
  // é¬¼æ»…
  ["é¬¼æ»…ã®åˆƒ","æ°´ã®å‘¼å¸ã®ä½¿ã„æ‰‹","ç‚ã®æŸ±ã®å¿ƒ","éŸ³ã§å ´ã‚’èª­ã‚€éšŠå£«","èŸ²ã®ã‚ˆã†ã«ç¹Šç´°ãªç™’ã—"],
  // NARUTO
  ["NARUTO","å½±åˆ†èº«ã®æˆ¦è¡“å®¶","åŒ»ç™‚å¿ã®å†·é™ã•","é¢¨éã®ä¿Šè¶³","å†™è¼ªçœ¼ã®è¦³å¯Ÿè€…"],
  // ã‚¸ãƒ–ãƒª
  ["Ghibli","é¢¨ã¨ã¨ã‚‚ã«å‹•ãå°‘å¥³","æ£®ã®ãƒˆãƒˆãƒ­çš„å®‰å¿ƒæ„Ÿ","ç©ºè³Šã®é™½æ°—ã•","æ¹¯å±‹ã®ç¾å ´ç›£ç£åŠ›"],
  // ã‚µãƒ³ãƒªã‚ª
  ["Sanrio","ã‚­ã‚­ã®ç©ºæ°—æ„Ÿ","ãƒ©ãƒ©ã®èª¿å’Œ","ã°ã¤ä¸¸ã®åéª¨","ã‚·ãƒŠãƒ¢ãƒ³ã®ã‚„ã•ã—ã•"],
  // ãƒãƒ¼ãƒ™ãƒ«
  ["Marvel","ã‚¹ãƒ¼ãƒ„ã§çŠ¶æ³ã‚’åè»¢ã™ã‚‹äºº","ç›¾ã§å®ˆã‚‹å¸ä»¤å¡”","é›·ã§æµã‚Œã‚’å¤‰ãˆã‚‹è€…","ã‚¹ãƒ‘ã‚¤ãƒ€ãƒ¼ãªæ©Ÿå‹•"],
  // FF
  ["FF","ç™½é­”ã®æ”¯æ´","é»’é­”ã®ä¸€æ’ƒ","ç«œé¨ã®è·³èº","åŸéŠè©©ã®ãƒãƒ•"],
  // ãƒ‰ãƒ©ã‚¯ã‚¨
  ["DQ","è³¢è€…ã®å…¨ä½“æŠŠæ¡","æ­¦é—˜å®¶ã®é–“åˆã„","éŠã³äººã®å ´ã»ãã—","å‹‡è€…ã®å‡æ•´"],
  // HÃ—H
  ["HxH","å…·ç¾åŒ–ã®è·äºº","å¤‰åŒ–ç³»ã®ç¬ç™º","ç‰¹è³ªã®ä¸å¯æ€è­°","æ”¾å‡ºã®æ¸…æµ"],
  // å¤©ä½¿ãƒ»æ‚ªé­”ãƒ»ç¥è©±
  ["Myth","åŠ è­·ã‚’é…ã‚‹å¤©ä½¿","å¡æ™ºã®å¥³ç¥","ç‹©ã‚Šã®ç¥ã®é›†ä¸­","å†¥ç•Œã®æ‰‰ç•ª"],
  // å‹•ç‰©ãƒ»è™«
  ["Nature","é·¹ã®ä¿¯ç°","ã‚¤ãƒ«ã‚«ã®é€£æº","ç‹ã®åˆ‡ã‚Šè¿”ã—","èœ‚ã®å‹¤å‹‰"]
];

/* é¡ä¼¼åº¦ï¼…ã‚’æ±ºã‚ã‚‹ï¼ˆç”Ÿå¹´æœˆæ—¥ãƒ™ãƒ¼ã‚¹ãƒ»å®‰å®šï¼‰ */
function ranking(dt, sixArr){
  const R=rngFromDate(dt);
  const boostIdx = sixArr.indexOf(Math.max(...sixArr)); // ãã®æ—¥ã®å¼·ã¿ã§å°‘ã—ä¸Šã’ã‚‹
  const list=[];
  POOL.forEach(([cat,...names])=>{
    names.forEach((name,i)=>{
      let p = 60 + Math.floor(R()*35);        // 60â€“95% åŸºæœ¬
      if((i%6)===boostIdx) p += 3;            // å¼·ã¿ä¸€è‡´ã§+3
      p = Math.min(p, 99);
      list.push({cat,name,p});
    });
  });
  return list.sort((a,b)=>b.p-a.p).slice(0,10);
}

/* ========= å††ã‚¢ãƒ‹ãƒ¡ ========= */
function drawArc(pct){
  const C=60,R=47;
  const a = Math.PI*2*pct;
  const x=C + R*Math.sin(a), y=C - R*Math.cos(a);
  const large = pct>0.5?1:0;
  const d = `M ${C} ${C-R} A ${R} ${R} 0 ${large} 1 ${x} ${y}`;
  $("arc").setAttribute("d", d);
}

/* ========= å®Ÿè¡Œ ========= */
$("run").onclick=()=>{
  const dt=parseDate($("dob").value);
  if(!dt){ $("err").style.display='block'; return; }
  $("err").style.display='none';

  // 6å¼ã¨åŸºæœ¬
  const s = six(dt);
  const b = base(s);
  const elem = elementFromSix(s);

  // å††ã‚¢ãƒ‹ãƒ¡ï¼ˆ1.1ç§’ã§å…‰ãŒåˆ»ã¾ã‚Œã‚‹ï¼‰
  let t=0; const T=60;
  const tick=()=>{ t++; drawArc(t/T); if(t<T) requestAnimationFrame(tick); };
  drawArc(0); requestAnimationFrame(tick);

  // ğŸ‘‘ ãŸã¾ã«ç‹å† 
  $("crown").style.display = (Math.max(...s)>=90)?'block':'none';

  // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
  const nick = $("nick").value.trim() || "æ—…äºº";
  $("who").textContent = `${nick} ï¼ ${elem.label}`;
  $("element").textContent = `å††:${s[0]} é¢¨:${s[1]} æ ¸:${s[2]} é–“:${s[3]} å’Œ:${s[4]} è¿”:${s[5]}`;

  const setBar=(id,val)=>{$(id).style.width=val+"%"; $(id+"v").textContent = val+"%";}
  setBar("hp", b.hp); setBar("mp", b.mp); setBar("sp", b.sp);

  // ãƒ©ãƒ³ã‚­ãƒ³ã‚°
  const top = ranking(dt, s);
  const list = $("list"); list.innerHTML="";
  top.forEach((r,idx)=>{
    const div=document.createElement("div"); div.className="rank"+(idx===0?" top":"");
    div.innerHTML=`<div style="font-weight:900;font-size:18px">${idx+1}</div>
      <div><div style="font-weight:900">${r.name}</div><div class="tag">${r.cat}</div></div>
      <div class="pct" style="font-weight:900">${r.p}%</div>`;
    list.appendChild(div);
  });

  // 6å¼ãƒ‘ãƒãƒ«
  const sixUl=$("six"); sixUl.innerHTML="";
  s.forEach((v,i)=>{
    const row=document.createElement("div"); row.className="row";
    row.innerHTML=`<div>${SIX_JA[i]}</div><div class="bar"><div class="fill" style="width:${v}%;background:linear-gradient(90deg,#ffd67a,#ffb300)"></div></div><div class="pct">${v}%</div>`;
    sixUl.appendChild(row);
  });

  // å…±æœ‰ç”»åƒã®ä¸‹æº–å‚™
  prepShareCanvas(nick, elem.label, s, top);

  $("board").hidden=false;
  toast("ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚");
};

/* ========= ã‚¿ãƒ– ========= */
document.querySelectorAll('.tab').forEach(t=>{
  t.onclick=()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('on'));
    t.classList.add('on');
    const id=t.dataset.tab;
    ["r","s","share"].forEach(k=>$("pan-"+k).style.display = (k===id)?"block":"none");
  };
});

/* ========= å…±æœ‰ï¼ˆç”»åƒç”Ÿæˆï¼†Web Shareï¼‰ ========= */
function prepShareCanvas(name, elem, s, top){
  const cvs=$("card"), g=cvs.getContext("2d");
  const W=cvs.width, H=cvs.height;
  // èƒŒæ™¯
  g.fillStyle="#eaf6ff"; g.fillRect(0,0,W,H);
  // ã‚¿ã‚¤ãƒˆãƒ«
  g.fillStyle="#0e1a2b"; g.font="700 44px Inter, system-ui"; g.fillText("KenGo OS â€” IKI STATUS", 48, 88);
  // å††
  g.save(); g.translate(220, 315);
  // å¤–æ 
  g.beginPath(); g.arc(0,0,120,0,Math.PI*2); g.strokeStyle="#bcd7f8"; g.lineWidth=4; g.stroke();
  // å…‰ã‚¢ãƒ¼ã‚¯
  const pct=0.92; g.beginPath(); g.arc(0,0,120,-Math.PI/2,-Math.PI/2+Math.PI*2*pct);
  const grd=g.createLinearGradient(-120,0,120,0); grd.addColorStop(0,"#8ec5ff"); grd.addColorStop(1,"#2b86ff");
  g.strokeStyle=grd; g.lineWidth=10; g.lineCap="round"; g.stroke();
  // å†…å´ã‚°ãƒ­ãƒ¼
  const rg=g.createRadialGradient(0,0,0,0,0,120); rg.addColorStop(0,"#ffffffee"); rg.addColorStop(0.6,"#ffffff55"); rg.addColorStop(1,"#ffffff00");
  g.fillStyle=rg; g.beginPath(); g.arc(0,0,120,0,Math.PI*2); g.fill();
  g.restore();

  // åå‰ã¨è¦ç´ 
  g.font="900 40px Inter, system-ui"; g.fillStyle="#0e1a2b"; g.fillText(`${name}`, 380, 190);
  g.font="700 28px Inter, system-ui"; g.fillStyle="#2b86ff"; g.fillText(`${elem}`, 380, 230);

  // 6å¼
  g.font="700 22px Inter, system-ui"; g.fillStyle="#5e6a7a";
  const L=["å††","é¢¨","æ ¸","é–“","å’Œ","è¿”"];
  L.forEach((t,i)=>{ g.fillText(`${t}  ${s[i]}%`, 380, 280+28*i); });

  // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ä¸Šä½5
  g.font="700 24px Inter, system-ui"; g.fillStyle="#0e1a2b"; g.fillText("ä¼¼ã¦ã‚‹OSãƒ©ãƒ³ã‚­ãƒ³ã‚°", 48, 468);
  g.font="700 22px Inter, system-ui"; g.fillStyle="#0e1a2b";
  top.slice(0,5).forEach((r,i)=>{ g.fillText(`${i+1}. ${r.name}  â€”  ${r.p}%`, 48, 508+34*i); });

  // ãƒ•ãƒƒã‚¿ãƒ¼
  g.font="600 18px Inter, system-ui"; g.fillStyle="#5e6a7a"; g.fillText("Â© KenGo System â€” é¢¨ã¯å¤–ã«ã€å††ã¯å†…ã«ã€‚", 48, 604);
}

$("save").onclick=()=>{
  const url=$("card").toDataURL("image/png");
  const a=document.createElement("a"); a.href=url; a.download="KenGo-IKI-STATUS.png"; a.click();
};

$("share").onclick=async()=>{
  try{
    const blob=await new Promise(res=>$("card").toBlob(res));
    const file=new File([blob],"KenGo-IKI-STATUS.png",{type:"image/png"});
    if(navigator.share && navigator.canShare && navigator.canShare({files:[file]})){
      await navigator.share({files:[file], title:"KenGo OS â€” IKI STATUS", text:"å††ãŒã§ããŸã€‚"});
    }else{
      $("save").click();
      toast("ç«¯æœ«å…±æœ‰ãŒæœªå¯¾å¿œã®ãŸã‚ä¿å­˜ã—ã¾ã—ãŸã€‚");
    }
  }catch(e){ toast("å…±æœ‰ã«å¤±æ•—ã—ã¾ã—ãŸ"); }
};

/* åˆæœŸå†† */
drawArc(0);
</script>
</body>
</html>